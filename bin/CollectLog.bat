@echo off
echo Collect logging information
echo clean up folder ...
del c:\Temp\log /S /Q
md c:\temp\log
set logFile=LogfileArchive%date:~-4,4%%date:~-10,2%%date:~-7,2%_%time:~1,1%%time:~3,2%%time:~6,2%.7z
echo getting MIL info  ...
call "C:\Program Files\Matrox Imaging\Tools\MILInfo.exe" -f
wevtutil epl Application c:\temp\log\ApplicationLog.evtx
wevtutil epl System c:\temp\log\SystemLog.evtx
tasklist > c:\temp\log\tasklist.log
echo getting network info 192.168.10.1 ...
ping 192.168.10.1 -n 10 > c:\temp\log\ping1.log
echo getting network info 192.168.10.2 ...
ping 192.168.10.2 -n 10 > c:\temp\log\ping2.log
echo getting network info 192.168.10.3 ...
ping 192.168.10.3 -n 10 > c:\temp\log\ping3.log
echo getting network info 192.168.10.4 ...
ping 192.168.10.4 -n 5 > c:\temp\log\ping4.log
echo getting network info 192.168.10.5 ...
ping 192.168.10.5 -n 5 > c:\temp\log\ping5.log
echo getting network info 192.168.10.6 ...
ping 192.168.10.6 -n 5 > c:\temp\log\ping6.log
echo getting network info 192.168.10.7 ...
ping 192.168.10.7 -n 5 > c:\temp\log\ping7.log
echo getting network info 192.168.10.8 ...
ping 192.168.10.8 -n 5 > c:\temp\log\ping8.log
echo getting network info 192.168.10.9 ...
ping 192.168.10.9 -n 10 > c:\temp\log\ping9.log
echo getting network info 192.168.10.10 ...
ping 192.168.10.10 -n 10 > c:\temp\log\ping10.log
echo getting network info internet ...
ping heise.de -n 2 > c:\temp\log\Internet.log
echo getting network configuration ...
ipconfig /all > c:\temp\log\ipConfig.log
echo checking space for system drive ...
Wmic logicaldisk where "DeviceID='C:'" get FreeSpace > c:\temp\log\diskspace.log
Wmic logicaldisk where "DeviceID='D:'" get FreeSpace >> c:\temp\log\diskspace.log
Wmic logicaldisk where "DeviceID='E:'" get FreeSpace >> c:\temp\log\diskspace.log
Wmic logicaldisk where "DeviceID='V:'" get FreeSpace >> c:\temp\log\diskspace.log
Wmic os get freephysicalmemory >> c:\temp\log\diskspace.log
copy C:\Users\SVIMRun\AppData\Local\Temp\SysInfo.txt c:\temp\log
echo getting system information ...
systeminfo > c:\temp\log\systeminfo.log
echo getting service information ...
net start > c:\temp\log\services.log
echo getting INI files ...
copy c:\SVObserver\bin\*.ini c:\Temp\log
echo getting InitializeIOSubsystem Log ...
copy "C:\SVObserver\InitializeIOSubsystem Log.txt" c:\temp\log
echo getting Last Configuration ...
md c:\temp\log\run
copy C:\RUN\*.* c:\temp\log\run
echo getting Images ...
md c:\temp\log\images
xcopy "D:\Application\Archive Images\Transfer\*.*" c:\temp\log\images /S
echo getting dump files ...
copy C:\SVObserver\DrWatson\*.* c:\Temp\log
D:\Utilities\7-Zip64\7z.exe a -t7z -r D:\Application\%logFile% c:\Temp\log\*.*
del c:\Temp\log /S /Q
echo ......................................................................
echo Archive completed
echo Please copy log archive from D:\Application\%logFile%
echo Hit a key to close this window
start /B "C:\Windows\system32\explorer.exe" "D:\Application"
pause